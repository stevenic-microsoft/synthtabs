# project-router

## purpose

Route requests to **project-specific** experts generated by the analyzer. These experts cover the frameworks, libraries, and tooling unique to the current codebase — knowledge that doesn't belong in the general-purpose `languages/` or `tools/` domains.

## task clusters

### SynthOS Pages — page lifecycle, storage, metadata, transformation, versioning, migrations
When: page, pages, page lifecycle, page metadata, pageVersion, migration, page mode,
  locked, unlocked, page cache, loadPageState, savePageState, page.json, page.html,
  page transformation, save page, copy page, delete page, required pages, page version
→ Read `.experts/.project/synthos-pages.md`

### agentm-core — AI abstraction layer, model routing, prompt completion
When: LLM, model, completePrompt, completion, chainOfThought, agentm, AI call,
  anthropic, openai, model routing, AgentCompletion, createCompletePrompt,
  generateImage, jsonMode, SystemMessage, UserMessage, prompt completion
→ Read `.experts/.project/agentm-core.md`

### Cheerio Transforms — DOM manipulation, node-ID system, CRUD operations
When: cheerio, DOM, data-node-id, node ID, assignNodeIds, stripNodeIds,
  CRUD operations, change list, applyChangeList, HTML injection, injectError,
  post-processing, postProcessV2, decodeEntities, replace element, insert element
→ Read `.experts/.project/cheerio-transforms.md`

### Express Routes — server architecture, route organization, middleware
When: express, route, endpoint, API route, middleware, server, requiresSettings,
  usePageRoutes, useApiRoutes, useDataRoutes, data route, SynthOSConfig,
  Content-Type, Cache-Control, body parser, route handler
→ Read `.experts/.project/express-routes.md`

### API Checklist — mandatory sync steps when adding or changing APIs
When: add API, new endpoint, new route, change API, remove endpoint, rename API,
  api explorer, serverAPIs, apis.html, API sync, update APIs, API documentation
→ Read `.experts/.project/api-checklist.md`

### Page Checklist — impact check when core page infrastructure changes
When: page-v2, helpers-v2, page script, page helpers, builder.html, builder page,
  injectPageInfoScript, injectPageHelpers, injectPageScript, ensureRequiredImports,
  REQUIRED_IMPORTS, SYSTEM_IDS, core page script, injection, injected script
→ Read `.experts/.project/page-checklist.md`

### SynthOS Themes — theme system, CSS custom properties, light/dark mode
When: theme, themes, CSS custom properties, light mode, dark mode, light-mode,
  dark-mode, theme-info, theme.css, ThemeInfo, loadTheme, loadThemeInfo,
  nebula-dusk, nebula-dawn, viewer-panel inline style, .light-mode override
→ Read `.experts/.project/synthos-themes.md`

### Prompt Templates — LLM prompt construction, system messages, transformation prompts
When: prompt, prompt template, system prompt, system message, user message, goal,
  serverAPIs, theme block, repair prompt, migration prompt, brainstorm prompt,
  model instructions, getModelInstructions, CURRENT_PAGE, SERVER_APIS, SERVER_SCRIPTS,
  THEME block, USER_MESSAGE, INSTRUCTIONS, MODEL_INSTRUCTIONS, repairGoal,
  parseChangeList, prompt construction, prompt section, prompt format
→ Read `.experts/.project/prompt-templates.md`

### Mocha Testing — test runner, coverage, test patterns
When: test, tests, mocha, ts-mocha, nyc, coverage, spec, test file, npm test,
  testing, assert, mock, test pattern, behavior test, test fixture
→ Read `.experts/.project/mocha-testing.md`

## combining rule

If a request touches multiple project experts, load all that match. Let the most specific expert lead (e.g., a framework expert over a general library expert).

## ambiguity fallback

If signals match this domain but no project expert exists yet, suggest running the analyzer:

> "No project-specific experts exist yet. Want me to analyze the codebase and recommend experts to create?"

## cross-domain note

Project experts are scoped to the current codebase's stack. They pair naturally with `../languages/` for idiomatic style and `../tools/` for general tooling. If a question is purely about language idioms or general Git/JSON/YAML usage, route there instead.

## file inventory

`agentm-core.md` | `api-checklist.md` | `cheerio-transforms.md` | `express-routes.md` | `mocha-testing.md` | `page-checklist.md` | `prompt-templates.md` | `synthos-pages.md` | `synthos-themes.md`
